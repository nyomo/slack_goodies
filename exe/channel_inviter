#!/usr/bin/env ruby
require "slack_goodies"

cli = SlackGoodies::Cli.new

mailaddr_regexp=cli.get(:mail)
channel_name=cli.get(:channel)

begin
  sl = SlackGoodies::Connection.new
rescue =>e
  puts "SlackConnectionError #{e.message}"
  exit
end

puts "以下のアカウントをチャンネルに招待します"
dryrun="[dryrun] " if cli.get(:dryrun) 
sl.email2userdata(mailaddr_regexp).each do |user|
  puts "#{dryrun}#{user["real_name"]}(#{user["profile"]["email"]})"
end
